import{__decorate as t,__metadata as e}from"tslib";import{ref as i,provide as s,watch as n}from"vue";import{Vue as a,mixins as o,setup as r,Options as h,prop as l}from"../../node_modules/vue-class-component/dist/vue-class-component.esm-bundler.js";import{Ref as d}from"../../utils/decorators.js";import c from"../../services/color-config/ColorMixin.js";import{StatefulMixin as f}from"../../mixins/StatefulMixin/StatefulMixin.js";import b from"../va-button/index.js";class p{constructor(t){this.parent=t,this.tabs=[],this.disabled=!1,this.disabled=t.disabled}register(t){const e=this.tabs.push(t);t.id=t.$props.name||e}unregister(t){this.tabs=this.tabs.filter((e=>e.id!==t.id)),this.tabs.forEach(((t,e)=>{t.id=t.$props.name||e}))}tabClick(t){console.log(1),this.parent.selectTab(t)}tabFocus(t){console.log(2),this.parent.moveToTab(t)}tabPressEnter(t){this.parent.selectTab(t)}}const u=a.with(class{constructor(){this.modelValue=l({type:[String,Number],default:null}),this.left=l({type:Boolean,default:!0}),this.right=l({type:Boolean,default:!1}),this.center=l({type:Boolean,default:!1}),this.grow=l({type:Boolean,default:!1}),this.disabled=l({type:Boolean,default:!1}),this.hideSlider=l({type:Boolean,default:!1}),this.vertical=l({type:Boolean,default:!1}),this.color=l({type:String,default:"primary"}),this.prevIcon=l({type:String,default:"chevron_left"}),this.nextIcon=l({type:String,default:"chevron_right"})}}),v=Symbol("TabsService");let g=class extends(o(c,f,u)){constructor(){super(...arguments),this.sliderHeight=null,this.sliderWidth=null,this.sliderOffsetX=0,this.sliderOffsetY=0,this.showPagination=!1,this.tabsContentOffset=0,this.resizeObserver=null,this.startingXPoint=0,this.animationIncluded=!1,this.context=r((()=>{const t=i(null);return s(v,t),{tabsService:t}}))}created(){this.context.tabsService=new p(this),n((()=>this.$props.modelValue),(()=>{this.updateTabsState()}))}get computedClass(){const{left:t,right:e,center:i,grow:s,disabled:n}=this.$props;return{"va-tabs__container--left":t&&!e&&!i&&!s,"va-tabs__container--right":e,"va-tabs__container--center":i,"va-tabs__container--grow":s,"va-tabs__container--disabled":n}}get computedTabsClass(){return{"va-tabs--vertical":this.$props.vertical}}get tabSelected(){return this.valueComputed}get sliderStyles(){if(this.$props.hideSlider)return{};const t=this.animationIncluded?"var(--va-tabs-slider-wrapper-transition)":"";return this.$props.vertical?{"background-color":this.colorComputed,height:`${this.sliderHeight}px`,transform:`translateY(-${this.sliderOffsetY}px) translateX(${this.sliderOffsetX}px)`,transition:t}:{"background-color":this.colorComputed,width:`${this.sliderWidth}px`,transform:`translateY(-${this.sliderOffsetY}px) translateX(${this.sliderOffsetX}px)`,transition:t}}get paginationControlledStyles(){if(this.$props.vertical)return{transform:"translateX(0px)"};const t=this.animationIncluded?"transform ease 0.3s":"";return{transform:`translateX(${this.startingXPoint-this.tabsContentOffset}px)`,transition:t}}get disablePaginationLeft(){return 0===this.tabsContentOffset}get disablePaginationRight(){var t;const e=null===(t=this.context.tabsService)||void 0===t?void 0:t.tabs[this.context.tabsService.tabs.length-1];return((null==e?void 0:e.rightSidePosition)||0)<=this.tabsContentOffset+this.containerRef.clientWidth||((null==e?void 0:e.leftSidePosition)||0)<=this.tabsContentOffset}selectTab(t){t&&(this.valueComputed=t.$props.name||t.id,this.stateful&&this.updateTabsState())}updateTabsState(){var t;this.resetSliderSizes(),null===(t=this.context.tabsService)||void 0===t||t.tabs.forEach((t=>{if(t.updateSidePositions(),this.tabSelected){const e=(t.$props.name||t.id)===this.tabSelected;t.isActive=t.isActiveRouterLink||e,t.isActive&&(this.moveToTab(t),this.updateSlider(t))}})),this.tabsContentOffset+this.containerRef.clientWidth>this.tabsRef.clientWidth&&this.context.tabsService&&this.moveToTab(this.context.tabsService.tabs[0]),this.updateStartingXPoint()}updatePagination(){this.showPagination=!1,this.tabsRef&&this.wrapperRef&&this.tabsRef.clientWidth>this.wrapperRef.clientWidth&&(this.showPagination=!0)}movePaginationLeft(){let t=this.tabsContentOffset-this.containerRef.clientWidth;if(this.context.tabsService)for(let e=0;e<this.context.tabsService.tabs.length-1;e++)if(this.context.tabsService.tabs[e].leftSidePosition>t&&this.context.tabsService.tabs[e].leftSidePosition<this.tabsContentOffset||this.context.tabsService.tabs[e+1].leftSidePosition>=this.tabsContentOffset){t=this.context.tabsService.tabs[e].leftSidePosition;break}this.tabsContentOffset=Math.max(0,t)}movePaginationRight(){var t;const e=this.tabsContentOffset+this.containerRef.clientWidth;let i=e;if(this.context.tabsService)for(let t=0;t<this.context.tabsService.tabs.length&&!(this.context.tabsService.tabs[t].rightSidePosition>e&&(i=this.context.tabsService.tabs[t].leftSidePosition,this.tabsContentOffset<i));t++);const s=null===(t=this.context.tabsService)||void 0===t?void 0:t.tabs[this.context.tabsService.tabs.length-1],n=((null==s?void 0:s.rightSidePosition)||0)-this.containerRef.clientWidth;i=Math.min(n,i),this.tabsContentOffset=Math.max(0,i)}moveToTab(t){this.showPagination&&t.leftSidePosition+this.containerRef.clientWidth<=this.tabsRef.clientWidth?this.tabsContentOffset=t.leftSidePosition:this.showPagination&&t.rightSidePosition>=this.containerRef.clientWidth?this.tabsContentOffset=t.rightSidePosition-this.containerRef.clientWidth:this.tabsContentOffset=0}updateSlider(t){this.$props.vertical?(this.sliderOffsetY=this.containerRef.clientHeight-t.$el.offsetTop-t.$el.clientHeight,this.sliderHeight=t.$el.clientHeight,this.sliderOffsetX=0,this.sliderWidth=null):(this.sliderOffsetX=t.$el.offsetLeft,this.sliderWidth=t.$el.clientWidth,this.sliderOffsetY=0,this.sliderHeight=null)}resetSliderSizes(){this.sliderWidth=0,this.sliderHeight=0}updateStartingXPoint(){var t,e,i,s;this.startingXPoint=0,this.showPagination&&(this.$props.right?this.startingXPoint=(null===(t=this.tabsRef)||void 0===t?void 0:t.clientWidth)-(null===(e=this.containerRef)||void 0===e?void 0:e.clientWidth):this.$props.center&&(this.startingXPoint=Math.floor(((null===(i=this.tabsRef)||void 0===i?void 0:i.clientWidth)-(null===(s=this.containerRef)||void 0===s?void 0:s.clientWidth))/2)))}includeAnimation(){this.animationIncluded||requestAnimationFrame((()=>{this.animationIncluded=!0}))}redrawTabs(){const t=this.showPagination;this.updatePagination(),t===this.showPagination?(this.updateTabsState(),this.includeAnimation()):requestAnimationFrame((()=>{this.updateTabsState(),this.includeAnimation()}))}mounted(){this.redrawTabs(),requestAnimationFrame((()=>{this.resizeObserver=new ResizeObserver(this.redrawTabs),this.resizeObserver.observe(this.wrapperRef),this.resizeObserver.observe(this.tabsRef)}))}beforeUnmount(){this.resizeObserver&&this.resizeObserver.disconnect()}};t([d("wrapper"),e("design:type",Element)],g.prototype,"wrapperRef",void 0),t([d("container"),e("design:type",Element)],g.prototype,"containerRef",void 0),t([d("tabs"),e("design:type",Element)],g.prototype,"tabsRef",void 0),g=t([h({name:"VaTabs",components:{VaButton:b}})],g);var m=g;export default m;export{p as TabsService,v as TabsServiceKey};
//# sourceMappingURL=VaTabs.vue_vue&type=script&lang.js.map
