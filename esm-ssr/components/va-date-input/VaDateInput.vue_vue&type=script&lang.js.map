{"version":3,"file":"VaDateInput.vue_vue&type=script&lang.js","sources":["../../../../src/components/va-date-input/VaDateInput.vue"],"sourcesContent":["<template>\n  <div class=\"va-date-input\">\n    <va-dropdown v-model=\"isOpenSync\" :offset=\"[0, 10]\" :close-on-content-click=\"false\">\n      <template #anchor>\n        <slot name=\"input\" v-bind=\"{ valueText, inputProps, color }\">\n          <va-input\n            v-model=\"valueText\"\n            v-bind=\"inputProps\"\n            class=\"va-date-input__input\"\n            @cleared=\"onClear\"\n          >\n            <template #appendInner=\"slotScope\">\n              <slot name=\"appendInner\" v-bind=\"slotScope\">\n                <va-icon\n                  name=\"calendar_today\"\n                  class=\"va-date-picker__icon\"\n                  size=\"small\"\n                  :color=\"color\"\n                />\n              </slot>\n            </template>\n\n            <template\n              v-for=\"(_, name) in $slots\"\n              :key=\"name\"\n              v-slot:[name]=\"slotScope\"\n            >\n              <slot :name=\"name\" v-bind=\"slotScope\" />\n            </template>\n          </va-input>\n        </slot>\n      </template>\n\n      <va-dropdown-content>\n        <va-date-picker v-bind=\"datePickerProps\" v-model=\"valueComputed\">\n          <template v-for=\"(_, name) in $slots\" v-slot:[name]=\"bind\">\n            <slot :name=\"name\" v-bind=\"bind\" />\n          </template>\n        </va-date-picker>\n      </va-dropdown-content>\n    </va-dropdown>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, PropType, toRefs, watch } from 'vue'\nimport { useStateful } from '../../mixins/StatefulMixin/cStatefulMixin'\n\nimport { isRange, isSingleDate, isDates } from '../va-date-picker/hooks/model-value-helper'\nimport { useSyncProp } from '../va-date-picker/hooks/sync-prop'\nimport { filterComponentProps, extractComponentProps } from '../va-date-picker/utils/child-props'\nimport { useRangeModelValueGuard } from './hooks/range-model-value-guard'\n\nimport VaDatePicker from '../va-date-picker/VaDatePicker.vue'\nimport VaInput from '../va-input'\nimport { VaDatePickerModelValue } from '../va-date-picker/types/types'\n\nconst VaInputProps = {\n  label: { type: String, required: false },\n  color: { type: String, default: 'primary' },\n  placeholder: { type: String, default: '' },\n  clearable: { type: Boolean, default: false },\n  tabindex: { type: Number, default: 0 },\n  outline: { Boolean, default: false },\n  bordered: { Boolean, default: false },\n  readonly: { Boolean, default: true },\n}\n\nexport default defineComponent({\n  name: 'VaDateInput',\n\n  components: { VaDatePicker, VaInput },\n\n  props: {\n    ...extractComponentProps(VaDatePicker),\n    ...VaInputProps,\n    resetOnClose: { type: Boolean, default: true },\n    isOpen: { type: Boolean },\n    format: { type: Function as PropType<(date: VaDatePickerModelValue | undefined) => string> },\n  },\n\n  emits: [\n    'update:modelValue',\n    'hover:day', 'hover:month',\n    'update:year', 'update:month', 'update:view',\n    'click:month', 'click:day',\n    'update:is-open',\n    'update:text',\n  ],\n\n  setup (props, { emit }) {\n    const { isOpen, resetOnClose } = toRefs(props)\n    const { valueComputed: statefulValue } = useStateful(props, emit)\n    const { syncProp: isOpenSync } = useSyncProp(isOpen, 'is-open', emit, false)\n\n    const isRangeModelValueGuardDisabled = computed(() => !resetOnClose.value)\n    const { valueComputed, reset } = useRangeModelValueGuard(statefulValue, isRangeModelValueGuardDisabled)\n    watch(isOpenSync, (isOpened) => { if (!isOpened && !isRangeModelValueGuardDisabled.value) { reset() } })\n\n    const dateOrNothing = (date: Date | undefined | null) => {\n      if (!date) { return '...' }\n      return date.toDateString()\n    }\n\n    const valueText = computed({\n      get: () => {\n        if (props.format) {\n          return props.format(valueComputed.value)\n        }\n\n        if (!valueComputed.value) { return '' }\n\n        if (isDates(valueComputed.value)) {\n          return valueComputed.value.map((d) => d.toDateString()).join(', ')\n        }\n        if (isSingleDate(valueComputed.value)) {\n          return valueComputed.value.toDateString()\n        }\n        if (isRange(valueComputed.value)) {\n          return dateOrNothing(valueComputed.value.start) + ' ~ ' + dateOrNothing(valueComputed.value.end)\n        }\n\n        throw new Error('VaDatePicker: Invalid model value. Value should be Date, Date[] or { start: Date, end: Date | null }')\n      },\n      set (value: string) {\n        // TODO: Parse value from input\n      },\n    })\n\n    watch(valueText, (text) => emit('update:text', text))\n\n    const onClear = () => { valueComputed.value = undefined }\n\n    return {\n      valueText,\n      valueComputed,\n      isOpenSync,\n      onClear,\n\n      inputProps: filterComponentProps(props, VaInputProps),\n      datePickerProps: filterComponentProps(props, extractComponentProps(VaDatePicker)),\n    }\n  },\n})\n</script>\n\n<style lang=\"scss\" scoped>\n  .va-date-input {\n    display: flex;\n\n    &__icon {\n      cursor: pointer;\n    }\n\n    &__input {\n      cursor: pointer;\n    }\n\n    --va-date-picker-cell-size: 28px;\n  }\n</style>\n"],"names":["VaInputProps","label","type","String","required","color","default","placeholder","clearable","Boolean","tabindex","Number","outline","bordered","readonly","defineComponent","name","components","VaDatePicker","VaInput","props","extractComponentProps","resetOnClose","isOpen","format","Function","emits","setup","emit","toRefs","valueComputed","statefulValue","useStateful","syncProp","isOpenSync","useSyncProp","isRangeModelValueGuardDisabled","computed","value","reset","useRangeModelValueGuard","watch","isOpened","dateOrNothing","date","toDateString","valueText","get","isDates","map","d","join","isSingleDate","isRange","start","end","Error","set","text","onClear","undefined","inputProps","filterComponentProps","datePickerProps"],"mappings":"kpBAyDA,MAAMA,EAAe,CACnBC,MAAO,CAAEC,KAAMC,OAAQC,UAAU,GACjCC,MAAO,CAAEH,KAAMC,OAAQG,QAAS,WAChCC,YAAa,CAAEL,KAAMC,OAAQG,QAAS,IACtCE,UAAW,CAAEN,KAAMO,QAASH,SAAS,GACrCI,SAAU,CAAER,KAAMS,OAAQL,QAAS,GACnCM,QAAS,CAAEH,QAAAA,QAASH,SAAS,GAC7BO,SAAU,CAAEJ,QAAAA,QAASH,SAAS,GAC9BQ,SAAU,CAAEL,QAAAA,QAASH,SAAS,IAGhC,MAAeS,EAAgB,CAC7BC,KAAM,cAENC,WAAY,cAAEC,EAAcC,QAAAA,GAE5BC,MAAO,IACFC,EAAsBH,MACtBlB,EACHsB,aAAc,CAAEpB,KAAMO,QAASH,SAAS,GACxCiB,OAAQ,CAAErB,KAAMO,SAChBe,OAAQ,CAAEtB,KAAMuB,WAGlBC,MAAO,CACL,oBACA,YAAa,cACb,cAAe,eAAgB,cAC/B,cAAe,YACf,iBACA,eAGFC,MAAOP,GAAOQ,KAAEA,IACd,MAAML,OAAEA,EAAMD,aAAEA,GAAiBO,EAAOT,IAChCU,cAAeC,GAAkBC,EAAYZ,EAAOQ,IACpDK,SAAUC,GAAeC,EAAYZ,EAAQ,UAAWK,GAAM,GAEhEQ,EAAiCC,GAAS,KAAOf,EAAagB,SAC9DR,cAAEA,EAAaS,MAAEA,GAAUC,EAAwBT,EAAeK,GACxEK,EAAMP,GAAaQ,IAAoBA,GAAaN,EAA+BE,OAASC,OAE5F,MAAMI,EAAiBC,GAChBA,EACEA,EAAKC,eADQ,MAIhBC,EAAYT,EAAS,CACzBU,IAAK,KACH,GAAI3B,EAAMI,OACR,OAAOJ,EAAMI,OAAOM,EAAcQ,OAGpC,IAAKR,EAAcQ,MAAS,MAAO,GAEnC,GAAIU,EAAQlB,EAAcQ,OACxB,OAAOR,EAAcQ,MAAMW,KAAKC,GAAMA,EAAEL,iBAAgBM,KAAK,MAE/D,GAAIC,EAAatB,EAAcQ,OAC7B,OAAOR,EAAcQ,MAAMO,eAE7B,GAAIQ,EAAQvB,EAAcQ,OACxB,OAAOK,EAAcb,EAAcQ,MAAMgB,OAAS,MAAQX,EAAcb,EAAcQ,MAAMiB,KAG9F,MAAM,IAAIC,MAAM,yGAElBC,IAAKnB,OAKPG,EAAMK,GAAYY,GAAS9B,EAAK,cAAe8B,KAI/C,MAAO,CACLZ,UAAAA,EACAhB,cAAAA,EACAI,WAAAA,EACAyB,QANc,KAAQ7B,EAAcQ,WAAQsB,GAQ5CC,WAAYC,EAAqB1C,EAAOpB,GACxC+D,gBAAiBD,EAAqB1C,EAAOC,EAAsBH"}