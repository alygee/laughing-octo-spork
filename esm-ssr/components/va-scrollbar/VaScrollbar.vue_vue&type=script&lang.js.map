{"version":3,"file":"VaScrollbar.vue_vue&type=script&lang.js","sources":["../../../../src/components/va-scrollbar/VaScrollbar.vue"],"sourcesContent":["<template>\n  <div\n    class=\"va-scrollbar\"\n    ref=\"vuesticScrollbar\"\n  >\n    <div\n      class=\"scrollbar-wrapper\"\n      ref=\"scrollbarWrapper\"\n    >\n      <div\n        class=\"scrollbar-content\"\n        ref=\"scrollbarContent\"\n        @wheel=\"scroll\"\n        @touchstart=\"startDrag\"\n        @touchmove=\"onDrag\"\n        @touchend=\"stopDrag\"\n        @transitionend=\"onContentResize\"\n      >\n        <slot />\n      </div>\n      <div\n        class=\"track\"\n        ref=\"track\"\n      >\n        <div\n          class=\"thumb\"\n          ref=\"thumb\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { detect } from 'detect-browser'\nimport erd from 'element-resize-detector'\n\nconst browser = detect()\n\nexport default {\n  name: 'VaScrollbar',\n  props: {\n    speed: {\n      type: Number,\n      default: 20,\n    },\n  },\n  methods: {\n    calcSize () {\n      this.isDown = this.isUp = false\n      this.maxHeight = parseFloat(this.wrapper.offsetHeight, 10)\n      this.contentHeight = parseFloat(this.content.offsetHeight, 10)\n      this.trackHeight = parseFloat(this.track.offsetHeight, 10)\n\n      if (this.maxHeight / this.contentHeight * this.trackHeight < 10) {\n        this.thumb.style.height = 10 + 'px'\n      } else {\n        this.thumb.style.height = this.maxHeight / this.contentHeight * this.trackHeight + 'px'\n      }\n\n      if (this.maxHeight / this.contentHeight < 1) {\n        this.thumb.classList.add('active')\n      } else {\n        this.thumb.classList.remove('active')\n      }\n    },\n    calcThumb () {\n      const currentMT = this.content.style.marginTop === ''\n        ? 0\n        : parseInt(this.content.style.marginTop, 10)\n      this.thumb.style.top = (-currentMT / this.contentHeight * this.trackHeight) + 'px'\n    },\n    onContentResize () {\n      const prevHeight = this.contentHeight\n      this.calcSize()\n      this.calcThumb()\n\n      this.content.style.transition = 'margin-top .3s linear'\n      this.thumb.style.transition = 'top .3s linear'\n      const handler = (e) => {\n        if (e.propertyName === 'margin-top') {\n          this.content.style.transition = ''\n          this.calcSize()\n          this.calcThumb()\n          this.content.removeEventListener('transitionend', handler)\n          this.thumb.style.transition = ''\n        }\n      }\n      this.content.addEventListener('transitionend', handler)\n\n      this.setVertical(this.contentHeight - prevHeight)\n    },\n    startDrag (e) {\n      this.isDragging = true\n      this.prevTouch = e.touches[0]\n    },\n    onDrag (e) {\n      if (this.isDragging) {\n        e.preventDefault()\n        const touch = e.touches[0]\n        const delta = this.prevTouch.clientY - touch.clientY\n        this.setVertical(delta)\n        this.prevTouch = touch\n      }\n    },\n    stopDrag () {\n      this.isDragging = false\n    },\n    scroll (e) {\n      let delta = (e.deltaY * 0.01 * this.speed)\n      if (browser.name === 'firefox') {\n        delta *= 10\n      }\n      this.setVertical(delta)\n      e.preventDefault()\n    },\n    setVertical (delta) {\n      if ((this.isDown && delta > 0) || (this.isUp && delta < 0) || (this.contentHeight <= this.maxHeight)) {\n        return\n      }\n      const currentMT = this.content.style.marginTop === ''\n        ? 0\n        : parseFloat(this.content.style.marginTop, 10)\n      let nextMT = 0\n      if (this.maxHeight - (currentMT - delta) > this.contentHeight && delta > 0) {\n        nextMT = this.maxHeight - this.contentHeight\n        this.isDown = true\n      } else {\n        this.isDown = false\n        if (currentMT - delta > 0) {\n          this.isUp = true\n          nextMT = 0\n        } else {\n          nextMT = currentMT - delta\n          this.isUp = false\n        }\n      }\n\n      this.content.style.marginTop = nextMT + 'px'\n      this.calcThumb()\n    },\n  },\n  mounted () {\n    this.track = this.$refs.track\n    this.thumb = this.$refs.thumb\n    this.content = this.$refs.scrollbarContent\n    this.wrapper = this.$refs.scrollbarWrapper\n    this.calcSize()\n    this.calcThumb()\n    erd.listenTo(this.content, () => {\n      this.calcSize()\n      this.calcThumb()\n    })\n  },\n  beforeUnmount () {\n    erd.removeAllListeners(this.content)\n  },\n  data () {\n    return {\n      wrapper: undefined,\n      maxHeight: undefined,\n      thumb: undefined,\n      track: undefined,\n      trackHeight: undefined,\n      content: undefined,\n      contentHeight: undefined,\n      isDown: false,\n      isUp: true,\n      prevTouch: {},\n      isDragging: false,\n    }\n  },\n}\n\n</script>\n\n<style lang=\"scss\">\n@import \"../../styles/resources/resources\";\n@import 'variables';\n\n.va-scrollbar {\n  background: var(--va-scrollbar-background);\n  transition: var(--va-scrollbar-transition);\n  position: var(--va-scrollbar-position);\n\n  .scrollbar-wrapper {\n    border-radius: var(--va-scrollbar-wrapper-border-radius);\n    box-shadow: var(--va-scrollbar-wrapper-box-shadow);\n    position: var(--va-scrollbar-wrapper-position);\n    overflow: var(--va-scrollbar-wrapper-overflow);\n    max-height: var(--va-scrollbar-wrapper-max-height);\n\n    .track {\n      width: var(--va-scrollbar-wrapper-track-width);\n      position: var(--va-scrollbar-wrapper-track-position);\n      right: var(--va-scrollbar-wrapper-track-right);\n      top: var(--va-scrollbar-wrapper-track-top);\n      height: var(--va-scrollbar-wrapper-track-height);\n\n      .thumb {\n        transition: var(--va-scrollbar-thumb-transition);\n        position: var(--va-scrollbar-thumb-position);\n        width: var(--va-scrollbar-thumb-width);\n        background-color: var(--va-scrollbar-thumb-background-color);\n        opacity: var(--va-scrollbar-thumb-opacity);\n\n        &.active {\n          opacity: 0.3;\n        }\n      }\n    }\n  }\n\n  &:hover {\n    .thumb.active {\n      opacity: 1 !important;\n    }\n  }\n}\n</style>\n"],"names":["browser","detect","name","props","speed","type","Number","default","methods","calcSize","this","isDown","isUp","maxHeight","parseFloat","wrapper","offsetHeight","contentHeight","content","trackHeight","track","thumb","style","height","classList","add","remove","calcThumb","currentMT","marginTop","parseInt","top","onContentResize","prevHeight","transition","handler","e","propertyName","removeEventListener","addEventListener","setVertical","startDrag","isDragging","prevTouch","touches","onDrag","preventDefault","touch","delta","clientY","stopDrag","scroll","deltaY","nextMT","mounted","$refs","scrollbarContent","scrollbarWrapper","erd","listenTo","beforeUnmount","removeAllListeners","data","undefined"],"mappings":"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"}