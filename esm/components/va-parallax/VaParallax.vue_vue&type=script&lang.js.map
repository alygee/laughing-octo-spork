{"version":3,"file":"VaParallax.vue_vue&type=script&lang.js","sources":["../../../../src/components/va-parallax/VaParallax.vue"],"sourcesContent":["<template>\n  <div\n    class=\"va-parallax\"\n    :style=\"computedWrapperStyles\"\n  >\n    <div class=\"va-parallax__image-container\">\n      <img\n        class=\"va-parallax__image\"\n        ref=\"img\"\n        :src=\"$props.src\"\n        :alt=\"$props.alt\"\n        :style=\"computedImgStyles\"\n      />\n    </div>\n    <div class=\"va-parallax__item-container\">\n      <slot></slot>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { Options, prop, Vue, mixins } from 'vue-class-component'\n\nclass ParallaxProps {\n  target = prop<Element | string>({ type: [Object, String], default: '' })\n  src = prop<string>({ type: String, default: '', required: true })\n  alt = prop<string>({ type: String, default: 'parallax' })\n  height = prop<number>({ type: Number, default: 400 })\n  reversed = prop<boolean>({ type: Boolean, default: false })\n  speed = prop<number>({\n    type: Number,\n    default: 0.5,\n    validator: (value: number) => {\n      return value >= 0 && value <= 1\n    },\n  })\n}\n\nconst ParallaxPropsMixin = Vue.with(ParallaxProps)\n\n@Options({\n  name: 'VaParallax',\n})\nexport default class VaParallax extends mixins(\n  ParallaxPropsMixin,\n) {\n  elOffsetTop = 0\n  parallax = 0\n  parallaxDist = 0\n  percentScrolled = 0\n  scrollTop = 0\n  windowHeight = 0\n  windowBottom = 0\n  isLoaded = false\n\n  get computedWrapperStyles (): Record<string, unknown> {\n    return {\n      height: this.$props.height + 'px',\n    }\n  }\n\n  get targetElement () {\n    return typeof this.$props.target === 'string'\n      ? document.querySelector(this.$props.target)\n      : this.$props.target || this.$el.parentElement\n  }\n\n  get computedImgStyles (): Record<string, unknown> {\n    return {\n      display: 'block',\n      transform: `translate(-50%, ${this.parallax}px)`,\n      opacity: this.isLoaded ? 1 : 0,\n      top: this.$props.reversed ? 0 : 'auto',\n    }\n  }\n\n  get imgHeight (): number {\n    // @ts-ignore\n    return this.$refs.img.naturalHeight\n  }\n\n  calcDimensions (): void {\n    const offset = this.$el.getBoundingClientRect()\n\n    this.scrollTop = this.targetElement.scrollTop\n    this.parallaxDist = this.imgHeight - (this.$props.height as number)\n    this.elOffsetTop = offset.top + this.scrollTop\n    this.windowHeight = window.innerHeight\n    this.windowBottom = this.scrollTop + this.windowHeight\n  }\n\n  translate (): void {\n    this.calcDimensions()\n    this.percentScrolled = (\n      (this.windowBottom - this.elOffsetTop) /\n      ((this.$props.height as number) + this.windowHeight)\n    )\n    this.parallax = Math.round(this.parallaxDist * this.percentScrolled) * (this.$props.speed as number)\n    if (this.$props.reversed) {\n      this.parallax = -this.parallax\n    }\n  }\n\n  addEventListeners (): void {\n    this.targetElement.addEventListener('scroll', this.translate)\n    this.targetElement.addEventListener('resize', this.translate)\n  }\n\n  removeEventListeners (): void {\n    this.targetElement.removeEventListener('scroll', this.translate)\n    this.targetElement.removeEventListener('resize', this.translate)\n  }\n\n  initImage (): void {\n    const img: HTMLImageElement = this.$refs.img as HTMLImageElement\n    if (img.complete) {\n      this.translate()\n      this.addEventListeners()\n    } else {\n      img.addEventListener('load', () => {\n        this.translate()\n        this.addEventListeners()\n      }, false)\n    }\n    this.isLoaded = true\n  }\n\n  mounted () {\n    this.initImage()\n  }\n\n  beforeUnmount () {\n    this.removeEventListeners()\n  }\n}\n</script>\n\n<style lang=\"scss\">\n@import '../../styles/resources/resources';\n@import 'variables';\n\n.va-parallax {\n  display: var(--va-parallax-display);\n  position: var(--va-parallax-position);\n  overflow: var(--va-parallax-overflow);\n  width: var(--va-parallax-width);\n  z-index: var(--va-parallax-z-index);\n\n  &__image-container {\n    position: var(--va-parallax-image-container-position);\n    top: var(--va-parallax-image-container-top);\n    left: var(--va-parallax-image-container-left);\n    right: var(--va-parallax-image-container-right);\n    bottom: var(--va-parallax-image-container-bottom);\n    z-index: var(--va-parallax-image-container-z-index);\n    contain: var(--va-parallax-image-container-contain);\n    user-select: var(--va-parallax-image-container-user-select);\n  }\n\n  &__image {\n    position: var(--va-parallax-image-position);\n    bottom: var(--va-parallax-image-bottom);\n    left: var(--va-parallax-image-left);\n    min-width: var(--va-parallax-image-min-width);\n    min-height: var(--va-parallax-image-min-height);\n    display: var(--va-parallax-image-display);\n    transform: var(--va-parallax-image-transform);\n    will-change: var(--va-parallax-image-will-change);\n    transition: var(--va-parallax-image-transition);\n    z-index: var(--va-parallax-image-z-index);\n  }\n\n  &__item-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 2;\n    contain: strict;\n  }\n}\n</style>\n"],"names":["ParallaxPropsMixin","Vue","with","constructor","this","prop","type","Object","String","default","required","Number","Boolean","validator","value","VaParallax","mixins","computedWrapperStyles","height","$props","targetElement","target","document","querySelector","$el","parentElement","computedImgStyles","display","transform","parallax","opacity","isLoaded","top","reversed","imgHeight","$refs","img","naturalHeight","calcDimensions","offset","getBoundingClientRect","scrollTop","parallaxDist","elOffsetTop","windowHeight","window","innerHeight","windowBottom","translate","percentScrolled","Math","round","speed","addEventListeners","addEventListener","removeEventListeners","removeEventListener","initImage","complete","mounted","beforeUnmount","Options","name"],"mappings":"2KAsCA,MAAMA,EAAqBC,EAAIC,KAf/B,MAAAC,cACEC,YAASC,EAAuB,CAAEC,KAAM,CAACC,OAAQC,QAASC,QAAS,KACnEL,SAAMC,EAAa,CAAEC,KAAME,OAAQC,QAAS,GAAIC,UAAU,IAC1DN,SAAMC,EAAa,CAAEC,KAAME,OAAQC,QAAS,aAC5CL,YAASC,EAAa,CAAEC,KAAMK,OAAQF,QAAS,MAC/CL,cAAWC,EAAc,CAAEC,KAAMM,QAASH,SAAS,IACnDL,WAAQC,EAAa,CACnBC,KAAMK,OACNF,QAAS,GACTI,UAAYC,GACHA,GAAS,GAAKA,GAAS,OAUpC,IAAqBC,EAArB,cAAwCC,EACtChB,IADFG,kCAGEC,iBAAc,EACdA,cAAW,EACXA,kBAAe,EACfA,qBAAkB,EAClBA,eAAY,EACZA,kBAAe,EACfA,kBAAe,EACfA,eAAW,EAEXa,4BACE,MAAO,CACLC,OAAQd,KAAKe,OAAOD,OAAS,MAIjCE,oBACE,MAAqC,iBAAvBhB,KAAKe,OAAOE,OACtBC,SAASC,cAAcnB,KAAKe,OAAOE,QACnCjB,KAAKe,OAAOE,QAAUjB,KAAKoB,IAAIC,cAGrCC,wBACE,MAAO,CACLC,QAAS,QACTC,UAAW,mBAAmBxB,KAAKyB,cACnCC,QAAS1B,KAAK2B,SAAW,EAAI,EAC7BC,IAAK5B,KAAKe,OAAOc,SAAW,EAAI,QAIpCC,gBAEE,OAAO9B,KAAK+B,MAAMC,IAAIC,cAGxBC,iBACE,MAAMC,EAASnC,KAAKoB,IAAIgB,wBAExBpC,KAAKqC,UAAYrC,KAAKgB,cAAcqB,UACpCrC,KAAKsC,aAAetC,KAAK8B,UAAa9B,KAAKe,OAAOD,OAClDd,KAAKuC,YAAcJ,EAAOP,IAAM5B,KAAKqC,UACrCrC,KAAKwC,aAAeC,OAAOC,YAC3B1C,KAAK2C,aAAe3C,KAAKqC,UAAYrC,KAAKwC,aAG5CI,YACE5C,KAAKkC,iBACLlC,KAAK6C,iBACF7C,KAAK2C,aAAe3C,KAAKuC,cACxBvC,KAAKe,OAAOD,OAAoBd,KAAKwC,cAEzCxC,KAAKyB,SAAWqB,KAAKC,MAAM/C,KAAKsC,aAAetC,KAAK6C,iBAAoB7C,KAAKe,OAAOiC,MAChFhD,KAAKe,OAAOc,WACd7B,KAAKyB,UAAYzB,KAAKyB,UAI1BwB,oBACEjD,KAAKgB,cAAckC,iBAAiB,SAAUlD,KAAK4C,WACnD5C,KAAKgB,cAAckC,iBAAiB,SAAUlD,KAAK4C,WAGrDO,uBACEnD,KAAKgB,cAAcoC,oBAAoB,SAAUpD,KAAK4C,WACtD5C,KAAKgB,cAAcoC,oBAAoB,SAAUpD,KAAK4C,WAGxDS,YACE,MAAMrB,EAAwBhC,KAAK+B,MAAMC,IACrCA,EAAIsB,UACNtD,KAAK4C,YACL5C,KAAKiD,qBAELjB,EAAIkB,iBAAiB,QAAQ,KAC3BlD,KAAK4C,YACL5C,KAAKiD,uBACJ,GAELjD,KAAK2B,UAAW,EAGlB4B,UACEvD,KAAKqD,YAGPG,gBACExD,KAAKmD,yBAzFYxC,KAHpB8C,EAAQ,CACPC,KAAM,gBAEa/C,SAAAA"}